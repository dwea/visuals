<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biological Processes Network</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        
        #container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .node {
            cursor: pointer;
            stroke: #fff;
            stroke-width: 2px;
        }
        
        .node.selected {
            stroke: #ff6b35;
            stroke-width: 4px;
        }
        
        .node.connected {
            stroke: #4ecdc4;
            stroke-width: 3px;
        }
        
        .node.dimmed {
            opacity: 0.3;
        }
        
        .link {
            stroke: #999;
            stroke-opacity: 0.6;
            stroke-width: 2px;
        }
        
        .link.highlighted {
            stroke: #4ecdc4;
            stroke-width: 4px;
            stroke-opacity: 0.9;
        }
        
        .link.dimmed {
            opacity: 0.2;
        }
        
        .node-label {
            font-size: 12px;
            font-weight: bold;
            text-anchor: middle;
            pointer-events: none;
            fill: #333;
        }
        
        .instructions {
            padding: 15px;
            background: #e8f4fd;
            border-bottom: 1px solid #bee5eb;
            font-size: 14px;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <h1>Interactive Biological Processes Network</h1>
    <div class="instructions">
        Click on any biological process to center the diagram around it. Connected processes will be highlighted.
    </div>
    <div id="container">
        <svg id="network"></svg>
    </div>

    <script>
        // Data: Biological processes with their connections
        const processes = [
            {id: "glycolysis", name: "Glycolysis", type: "metabolic", x: 300, y: 200},
            {id: "krebs", name: "Krebs Cycle", type: "metabolic", x: 400, y: 300},
            {id: "etc", name: "Electron Transport", type: "metabolic", x: 500, y: 250},
            {id: "photosynthesis", name: "Photosynthesis", type: "metabolic", x: 200, y: 150},
            {id: "transcription", name: "Transcription", type: "genetic", x: 350, y: 100},
            {id: "translation", name: "Translation", type: "genetic", x: 450, y: 150},
            {id: "replication", name: "DNA Replication", type: "genetic", x: 250, y: 100},
            {id: "cellcycle", name: "Cell Cycle", type: "cellular", x: 150, y: 250},
            {id: "apoptosis", name: "Apoptosis", type: "cellular", x: 100, y: 200}
        ];

        // Connections between processes
        const connections = [
            {source: "glycolysis", target: "krebs"},
            {source: "krebs", target: "etc"},
            {source: "photosynthesis", target: "glycolysis"},
            {source: "transcription", target: "translation"},
            {source: "replication", target: "transcription"},
            {source: "cellcycle", target: "replication"},
            {source: "cellcycle", target: "apoptosis"},
            {source: "etc", target: "cellcycle"},
            {source: "translation", target: "glycolysis"}
        ];

        // Color scheme for different process types
        const colorScale = d3.scaleOrdinal()
            .domain(["metabolic", "genetic", "cellular"])
            .range(["#ff9999", "#99ccff", "#99ff99"]);

        // SVG setup
        const width = 800;
        const height = 500;
        
        const svg = d3.select("#network")
            .attr("width", width)
            .attr("height", height);

        let selectedNode = null;

        // Create force simulation
        const simulation = d3.forceSimulation(processes)
            .force("link", d3.forceLink(connections).id(d => d.id).distance(80))
            .force("charge", d3.forceManyBody().strength(-300))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("collision", d3.forceCollide().radius(40));

        // Create links
        const link = svg.append("g")
            .selectAll("line")
            .data(connections)
            .join("line")
            .attr("class", "link");

        // Create nodes
        const node = svg.append("g")
            .selectAll("circle")
            .data(processes)
            .join("circle")
            .attr("class", "node")
            .attr("r", 25)
            .attr("fill", d => colorScale(d.type))
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended))
            .on("click", handleNodeClick);

        // Create labels
        const labels = svg.append("g")
            .selectAll("text")
            .data(processes)
            .join("text")
            .attr("class", "node-label")
            .text(d => d.name)
            .attr("dy", ".35em");

        // Handle node selection
        function handleNodeClick(event, d) {
            event.stopPropagation();
            
            // Update selected node
            selectedNode = d;
            
            // Get connected nodes
            const connectedNodes = new Set();
            const highlightedLinks = new Set();
            
            connections.forEach(link => {
                if (link.source.id === d.id || link.target.id === d.id) {
                    connectedNodes.add(link.source.id);
                    connectedNodes.add(link.target.id);
                    highlightedLinks.add(link);
                }
            });

            // Update visual states
            updateVisualStates(d.id, connectedNodes, highlightedLinks);
            
            // Animate to center the selected node
            centerOnNode(d);
        }

        function updateVisualStates(selectedId, connectedNodes, highlightedLinks) {
            // Update node styles
            node
                .classed("selected", d => d.id === selectedId)
                .classed("connected", d => d.id !== selectedId && connectedNodes.has(d.id))
                .classed("dimmed", d => !connectedNodes.has(d.id));

            // Update link styles
            link
                .classed("highlighted", d => highlightedLinks.has(d))
                .classed("dimmed", d => !highlightedLinks.has(d));
        }

        function centerOnNode(targetNode) {
            // Calculate translation to center the node
            const centerX = width / 2;
            const centerY = height / 2;
            
            // Smoothly transition all elements
            const transition = svg.transition().duration(750);
            
            // Update force center
            simulation.force("center", d3.forceCenter(centerX, centerY));
            
            // Apply a temporary attractive force toward the selected node
            simulation.force("selected", d3.forceRadial(0, targetNode.x, targetNode.y).strength(0.1));
            
            // Restart simulation with reduced alpha for smooth animation
            simulation.alpha(0.3).restart();
            
            // Remove the temporary force after animation
            setTimeout(() => {
                simulation.force("selected", null);
            }, 750);
        }

        // Update positions on each simulation tick
        simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node
                .attr("cx", d => d.x)
                .attr("cy", d => d.y);
            
            labels
                .attr("x", d => d.x)
                .attr("y", d => d.y);
        });

        // Clear selection when clicking on background
        svg.on("click", function() {
            selectedNode = null;
            node.classed("selected connected dimmed", false);
            link.classed("highlighted dimmed", false);
            
            // Reset to original center
            simulation.force("center", d3.forceCenter(width / 2, height / 2));
            simulation.alpha(0.2).restart();
        });

        // Drag functions
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }
    </script>
</body>
</html>
